package rentalapp;

import controller.MobilController;
import controller.PelangganController;
import controller.PenyewaanController;
import controller.SopirController;
import java.text.NumberFormat;
import java.util.List;
import java.util.Locale;
import javax.swing.table.DefaultTableModel;
import model.Mobil;
import model.Pelanggan;
import model.Penyewaan;
import model.Sopir;
import utils.DateUtil;

/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
/**
 *
 * @author ThinkPad
 */
public class PenyewaanPanel extends javax.swing.JPanel {

        // Controllers
        private MobilController mobilController;
        private PelangganController pelangganController;
        private SopirController sopirController;
        private PenyewaanController penyewaanController;

        /**
         * Creates new form PenyewaanPanel
         */
        public PenyewaanPanel() {
                initComponents();
                // Initialize controllers
                mobilController = new MobilController();
                pelangganController = new PelangganController();
                sopirController = new SopirController();
                penyewaanController = new PenyewaanController();

                // Initialize the panel
                init();
        }

        /**
         * This method is called from within the constructor to initialize the form.
         * WARNING: Do NOT modify this code. The content of this method is always
         * regenerated by the Form Editor.
         */
        @SuppressWarnings("unchecked")
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // Code">//GEN-BEGIN:initComponents
        private void initComponents() {

                jPanel1 = new javax.swing.JPanel();
                jLabel1 = new javax.swing.JLabel();
                jPanel2 = new javax.swing.JPanel();
                jLabel2 = new javax.swing.JLabel();
                txtidmobil = new javax.swing.JTextField();
                txtnopolisi = new javax.swing.JTextField();
                jLabel3 = new javax.swing.JLabel();
                jLabel4 = new javax.swing.JLabel();
                txtmerk = new javax.swing.JTextField();
                jLabel5 = new javax.swing.JLabel();
                txthargamobil = new javax.swing.JTextField();
                jLabel6 = new javax.swing.JLabel();
                txttahun = new com.toedter.calendar.JYearChooser();
                btnlistmobil = new javax.swing.JButton();
                jSeparator1 = new javax.swing.JSeparator();
                jPanel3 = new javax.swing.JPanel();
                jLabel7 = new javax.swing.JLabel();
                txtidpelanggan = new javax.swing.JTextField();
                txtnamapelanggan = new javax.swing.JTextField();
                jLabel8 = new javax.swing.JLabel();
                jLabel9 = new javax.swing.JLabel();
                txtnohp = new javax.swing.JTextField();
                jLabel10 = new javax.swing.JLabel();
                btnlistpelanggan = new javax.swing.JButton();
                jSeparator2 = new javax.swing.JSeparator();
                jScrollPane1 = new javax.swing.JScrollPane();
                txtalamat = new javax.swing.JTextArea();
                jPanel4 = new javax.swing.JPanel();
                jLabel11 = new javax.swing.JLabel();
                txtidsopir = new javax.swing.JTextField();
                txtnamasopir = new javax.swing.JTextField();
                jLabel12 = new javax.swing.JLabel();
                jLabel13 = new javax.swing.JLabel();
                txtnosim = new javax.swing.JTextField();
                txttarifsopir = new javax.swing.JTextField();
                jLabel15 = new javax.swing.JLabel();
                btnlistsopir = new javax.swing.JButton();
                jSeparator3 = new javax.swing.JSeparator();
                btntanpasopir = new javax.swing.JButton();
                jPanel5 = new javax.swing.JPanel();
                jLabel14 = new javax.swing.JLabel();
                txttanggalsewa = new com.toedter.calendar.JDateChooser();
                jLabel16 = new javax.swing.JLabel();
                txttanggalpengembalian = new com.toedter.calendar.JDateChooser();
                jLabel17 = new javax.swing.JLabel();
                labeltotalhari = new javax.swing.JLabel();
                jLabel19 = new javax.swing.JLabel();
                labeltotalharga = new javax.swing.JLabel();
                btnsewa = new javax.swing.JButton();
                btnhitung = new javax.swing.JButton();
                btnclear = new javax.swing.JButton();
                jSeparator4 = new javax.swing.JSeparator();
                jPanel6 = new javax.swing.JPanel();
                jScrollPane2 = new javax.swing.JScrollPane();
                tpenyewaan = new javax.swing.JTable();
                jLabel18 = new javax.swing.JLabel();
                labelidpenyewaan = new javax.swing.JLabel();
                btnhapus = new javax.swing.JButton();
                btnrefresh = new javax.swing.JButton();

                jPanel1.setBackground(new java.awt.Color(28, 147, 239));
                jPanel1.setForeground(new java.awt.Color(255, 255, 255));

                jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
                jLabel1.setForeground(new java.awt.Color(255, 255, 255));
                jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                jLabel1.setText("Data Penyewaan");

                javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
                jPanel1.setLayout(jPanel1Layout);
                jPanel1Layout.setHorizontalGroup(
                                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel1Layout.createSequentialGroup()
                                                                .addGap(215, 215, 215)
                                                                .addComponent(jLabel1,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addGap(214, 214, 214)));
                jPanel1Layout.setVerticalGroup(
                                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel1Layout.createSequentialGroup()
                                                                .addGap(20, 20, 20)
                                                                .addComponent(jLabel1,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                37,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addGap(20, 20, 20)));

                jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder("Mobil"));

                jLabel2.setText("ID Mobil");

                txtidmobil.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                txtidmobilActionPerformed(evt);
                        }
                });

                txtnopolisi.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                txtnopolisiActionPerformed(evt);
                        }
                });

                jLabel3.setText("No Polisi");

                jLabel4.setText("Merk");

                txtmerk.setEnabled(false);

                jLabel5.setText("Tahun");

                txthargamobil.setEnabled(false);

                jLabel6.setText("Harga Sewa");

                txttahun.setDayChooser(null);
                txttahun.setEnabled(false);

                btnlistmobil.setText("List Mobil");
                btnlistmobil.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnlistmobilActionPerformed(evt);
                        }
                });

                javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
                jPanel2.setLayout(jPanel2Layout);
                jPanel2Layout.setHorizontalGroup(
                                jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel2Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addGroup(jPanel2Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGroup(jPanel2Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                                                                false)
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel2,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtidmobil,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel3,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtnopolisi,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel4,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtmerk,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel5,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txttahun,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                Short.MAX_VALUE))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel6,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txthargamobil,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)))
                                                                                                .addGap(0, 0, Short.MAX_VALUE))
                                                                                .addComponent(jSeparator1)
                                                                                .addComponent(btnlistmobil,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE))
                                                                .addContainerGap()));
                jPanel2Layout.setVerticalGroup(
                                jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel2Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel2,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtidmobil,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel3,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtnopolisi,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel4,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtmerk,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jLabel5,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txttahun,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel6,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txthargamobil,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addComponent(jSeparator1,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(btnlistmobil)
                                                                .addContainerGap()));

                jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder("Pelanggan"));

                jLabel7.setText("ID Pelanggan");

                txtidpelanggan.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                txtidpelangganActionPerformed(evt);
                        }
                });

                txtnamapelanggan.setEnabled(false);

                jLabel8.setText("Nama");

                jLabel9.setText("No Hp");

                txtnohp.setEnabled(false);

                jLabel10.setText("Alamat");

                btnlistpelanggan.setText("List Pelanggan");
                btnlistpelanggan.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnlistpelangganActionPerformed(evt);
                        }
                });

                txtalamat.setColumns(20);
                txtalamat.setRows(5);
                txtalamat.setEnabled(false);
                jScrollPane1.setViewportView(txtalamat);

                javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
                jPanel3.setLayout(jPanel3Layout);
                jPanel3Layout.setHorizontalGroup(
                                jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel3Layout.createSequentialGroup()
                                                                .addGroup(jPanel3Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addGroup(jPanel3Layout
                                                                                                .createSequentialGroup()
                                                                                                .addContainerGap()
                                                                                                .addGroup(jPanel3Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                                .addGroup(jPanel3Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel10,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(jScrollPane1,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                229,
                                                                                                                                                Short.MAX_VALUE))
                                                                                                                .addGroup(jPanel3Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel9,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtnohp))
                                                                                                                .addGroup(jPanel3Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel7,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtidpelanggan))
                                                                                                                .addGroup(jPanel3Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel8,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtnamapelanggan))))
                                                                                .addGroup(jPanel3Layout
                                                                                                .createSequentialGroup()
                                                                                                .addContainerGap()
                                                                                                .addComponent(jSeparator2))
                                                                                .addGroup(jPanel3Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGap(10, 10, 10)
                                                                                                .addComponent(btnlistpelanggan,
                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                Short.MAX_VALUE)))
                                                                .addContainerGap()));
                jPanel3Layout.setVerticalGroup(
                                jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel3Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel3Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel7,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtidpelanggan,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel3Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel8,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtnamapelanggan,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel3Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel9,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtnohp,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel3Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jLabel10,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(jScrollPane1,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addComponent(jSeparator2,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(btnlistpelanggan)
                                                                .addGap(19, 19, 19)));

                jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder("Sopir"));

                jLabel11.setText("ID Sopir");

                txtidsopir.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                txtidsopirActionPerformed(evt);
                        }
                });

                txtnamasopir.setEnabled(false);

                jLabel12.setText("Nama");

                jLabel13.setText("No. SIM");

                txtnosim.setEnabled(false);

                txttarifsopir.setEnabled(false);

                jLabel15.setText("Tarif/Hari");

                btnlistsopir.setText("List Sopir");
                btnlistsopir.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnlistsopirActionPerformed(evt);
                        }
                });

                btntanpasopir.setText("Tanpa Sopir");
                btntanpasopir.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btntanpasopirActionPerformed(evt);
                        }
                });

                javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
                jPanel4.setLayout(jPanel4Layout);
                jPanel4Layout.setHorizontalGroup(
                                jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel4Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel4Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jSeparator3)
                                                                                .addGroup(jPanel4Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGroup(jPanel4Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                                .addGroup(jPanel4Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel11,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtidsopir,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                                .addGroup(jPanel4Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel12,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtnamasopir,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                                .addGroup(jPanel4Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel13,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txtnosim,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                                .addGroup(jPanel4Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel15,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                84,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(txttarifsopir,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                97,
                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)))
                                                                                                .addGap(0, 0, Short.MAX_VALUE)))
                                                                .addContainerGap())
                                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout
                                                                .createSequentialGroup()
                                                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addComponent(btnlistsopir)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(btntanpasopir)
                                                                .addGap(11, 11, 11)));
                jPanel4Layout.setVerticalGroup(
                                jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel4Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel4Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel11,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtidsopir,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel4Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel12,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtnamasopir,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel4Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel13,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txtnosim,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel4Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel15,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                22,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(txttarifsopir,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addComponent(jSeparator3,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel4Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(btnlistsopir)
                                                                                .addComponent(btntanpasopir))
                                                                .addContainerGap()));

                jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Form Penyewaan",
                                javax.swing.border.TitledBorder.CENTER,
                                javax.swing.border.TitledBorder.DEFAULT_POSITION));
                jPanel5.setToolTipText("");

                jLabel14.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
                jLabel14.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                jLabel14.setText("Tanggal Sewa");

                txttanggalsewa.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N

                jLabel16.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
                jLabel16.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                jLabel16.setText("Tanggal Pengembalian");

                txttanggalpengembalian.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N

                jLabel17.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
                jLabel17.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                jLabel17.setText("Total Hari");

                labeltotalhari.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
                labeltotalhari.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                labeltotalhari.setText("-");

                jLabel19.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
                jLabel19.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                jLabel19.setText("Total Harga");

                labeltotalharga.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
                labeltotalharga.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                labeltotalharga.setText("-");

                btnsewa.setText("Sewa");
                btnsewa.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnsewaActionPerformed(evt);
                        }
                });

                btnhitung.setText("Hitung");
                btnhitung.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnhitungActionPerformed(evt);
                        }
                });

                btnclear.setText("Bersihkan");
                btnclear.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnclearActionPerformed(evt);
                        }
                });

                javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
                jPanel5.setLayout(jPanel5Layout);
                jPanel5Layout.setHorizontalGroup(
                                jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel5Layout.createSequentialGroup()
                                                                .addGap(188, 188, 188)
                                                                .addGroup(jPanel5Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                false)
                                                                                .addComponent(jLabel14,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE)
                                                                                .addComponent(txttanggalsewa,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                144,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addGap(18, 18, 18)
                                                                .addGroup(jPanel5Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                false)
                                                                                .addComponent(jLabel16,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE)
                                                                                .addComponent(txttanggalpengembalian,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                144,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addGap(18, 18, 18)
                                                                .addGroup(jPanel5Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jLabel17,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                101,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(labeltotalhari,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                101,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addGap(18, 18, 18)
                                                                .addGroup(jPanel5Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                false)
                                                                                .addComponent(labeltotalharga,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE)
                                                                                .addComponent(jLabel19,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                169,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel5Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(btnhitung,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                132,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(btnsewa,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                132,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(btnclear,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                132,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addContainerGap(239, Short.MAX_VALUE)));
                jPanel5Layout.setVerticalGroup(
                                jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel5Layout.createSequentialGroup()
                                                                .addComponent(btnhitung)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(btnsewa)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(btnclear)
                                                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE))
                                                .addGroup(jPanel5Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel5Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                false)
                                                                                .addGroup(jPanel5Layout
                                                                                                .createSequentialGroup()
                                                                                                .addComponent(jLabel14)
                                                                                                .addPreferredGap(
                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                .addComponent(txttanggalsewa,
                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                Short.MAX_VALUE))
                                                                                .addGroup(jPanel5Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGroup(jPanel5Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                                                .addComponent(jLabel16)
                                                                                                                .addComponent(jLabel17)
                                                                                                                .addComponent(jLabel19))
                                                                                                .addPreferredGap(
                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                .addGroup(jPanel5Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                                                                false)
                                                                                                                .addComponent(labeltotalhari,
                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                28,
                                                                                                                                Short.MAX_VALUE)
                                                                                                                .addComponent(txttanggalpengembalian,
                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                Short.MAX_VALUE)
                                                                                                                .addComponent(labeltotalharga))))
                                                                .addGap(0, 0, Short.MAX_VALUE)));

                jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Data Penyewaan",
                                javax.swing.border.TitledBorder.CENTER,
                                javax.swing.border.TitledBorder.DEFAULT_POSITION));

                tpenyewaan.setModel(new javax.swing.table.DefaultTableModel(
                                new Object[][] {
                                                { null, null, null, null },
                                                { null, null, null, null },
                                                { null, null, null, null },
                                                { null, null, null, null }
                                },
                                new String[] {
                                                "Title 1", "Title 2", "Title 3", "Title 4"
                                }));
                tpenyewaan.addMouseListener(new java.awt.event.MouseAdapter() {
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                                tpenyewaanMouseClicked(evt);
                        }
                });
                jScrollPane2.setViewportView(tpenyewaan);

                javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
                jPanel6.setLayout(jPanel6Layout);
                jPanel6Layout.setHorizontalGroup(
                                jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(jScrollPane2));
                jPanel6Layout.setVerticalGroup(
                                jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(jScrollPane2, javax.swing.GroupLayout.Alignment.TRAILING,
                                                                javax.swing.GroupLayout.DEFAULT_SIZE, 194,
                                                                Short.MAX_VALUE));

                jLabel18.setText("ID Peyewaan");

                labelidpenyewaan.setText("-");

                btnhapus.setText("Hapus");
                btnhapus.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnhapusActionPerformed(evt);
                        }
                });

                btnrefresh.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/refresh.png"))); // NOI18N
                btnrefresh.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnrefreshActionPerformed(evt);
                        }
                });

                javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
                this.setLayout(layout);
                layout.setHorizontalGroup(
                                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addGroup(layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jPanel6,
                                                                                                javax.swing.GroupLayout.Alignment.TRAILING,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE)
                                                                                .addComponent(jPanel5,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE)
                                                                                .addComponent(jSeparator4)
                                                                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING,
                                                                                                layout.createSequentialGroup()
                                                                                                                .addGap(0, 0, Short.MAX_VALUE)
                                                                                                                .addComponent(jPanel3,
                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                .addPreferredGap(
                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                .addGroup(layout.createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                                                .addGroup(layout.createSequentialGroup()
                                                                                                                                                .addComponent(jLabel18,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                                80,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                                .addPreferredGap(
                                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                                .addComponent(labelidpenyewaan,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                                80,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                                .addPreferredGap(
                                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                                .addComponent(btnhapus))
                                                                                                                                .addGroup(layout.createSequentialGroup()
                                                                                                                                                .addComponent(jPanel2,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                                .addPreferredGap(
                                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                                .addComponent(jPanel4,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                                                                .addPreferredGap(
                                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                                .addComponent(btnrefresh,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                                                37,
                                                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)))
                                                                                                                .addGap(0, 0, Short.MAX_VALUE)))
                                                                .addContainerGap()));
                layout.setVerticalGroup(
                                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(layout.createSequentialGroup()
                                                                .addComponent(jPanel1,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addGap(18, 18, 18)
                                                                .addGroup(layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jPanel3,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addGroup(layout.createSequentialGroup()
                                                                                                .addGroup(layout.createParallelGroup(
                                                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                                .addGroup(layout.createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                                                                false)
                                                                                                                                .addComponent(jPanel2,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                Short.MAX_VALUE)
                                                                                                                                .addComponent(jPanel4,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                                Short.MAX_VALUE))
                                                                                                                .addComponent(btnrefresh))
                                                                                                .addPreferredGap(
                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                .addGroup(layout.createParallelGroup(
                                                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                                                false)
                                                                                                                .addComponent(btnhapus,
                                                                                                                                javax.swing.GroupLayout.Alignment.TRAILING)
                                                                                                                .addComponent(jLabel18,
                                                                                                                                javax.swing.GroupLayout.Alignment.TRAILING,
                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                                Short.MAX_VALUE)
                                                                                                                .addComponent(labelidpenyewaan,
                                                                                                                                javax.swing.GroupLayout.Alignment.TRAILING,
                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                                25,
                                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                                                                8, Short.MAX_VALUE)
                                                                .addComponent(jSeparator4,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                10,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                .addComponent(jPanel5,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(jPanel6,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addContainerGap()));
        }// </editor-fold>//GEN-END:initComponents

        private void btnrefreshActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnrefreshActionPerformed
                refreshPenyewaanTable();
        }// GEN-LAST:event_btnrefreshActionPerformed

        private void btnhapusActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnhapusActionPerformed
                // Check if a penyewaan is selected
                String idPenyewaanText = labelidpenyewaan.getText();

                if (idPenyewaanText.equals("-")) {
                        javax.swing.JOptionPane.showMessageDialog(this,
                                        "Harap pilih data penyewaan terlebih dahulu!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                // Confirm with user
                int confirm = javax.swing.JOptionPane.showConfirmDialog(this,
                                "Anda yakin ingin menghapus data penyewaan ini?",
                                "Konfirmasi", javax.swing.JOptionPane.YES_NO_OPTION);

                if (confirm == javax.swing.JOptionPane.YES_OPTION) {
                        try {
                                // Get penyewaan ID
                                int idPenyewaan = Integer.parseInt(idPenyewaanText);

                                // Delete the penyewaan
                                controller.PenyewaanController penyewaanController = new controller.PenyewaanController();
                                boolean success = penyewaanController.deletePenyewaan(idPenyewaan);

                                if (success) {
                                        javax.swing.JOptionPane.showMessageDialog(this,
                                                        "Data penyewaan berhasil dihapus!",
                                                        "Sukses", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                                        // Refresh table and clear form
                                        labelidpenyewaan.setText("-");
                                        clearForm();
                                        refreshPenyewaanTable();
                                } else {
                                        javax.swing.JOptionPane.showMessageDialog(this,
                                                        "Gagal menghapus data penyewaan!",
                                                        "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                }
                        } catch (Exception e) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "Error: " + e.getMessage(),
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                e.printStackTrace();
                        }
                }
        }// GEN-LAST:event_btnhapusActionPerformed

        private void tpenyewaanMouseClicked(java.awt.event.MouseEvent evt) {// GEN-FIRST:event_tpenyewaanMouseClicked
                // Get selected row
                int selectedRow = tpenyewaan.getSelectedRow();

                if (selectedRow >= 0) {
                        // Get ID from first column
                        int idSewa = (int) tpenyewaan.getValueAt(selectedRow, 0);
                        labelidpenyewaan.setText(String.valueOf(idSewa));

                        // Get penyewaan data
                        try {
                                controller.PenyewaanController penyewaanController = new controller.PenyewaanController();
                                model.Penyewaan penyewaan = penyewaanController.getPenyewaanById(idSewa);

                                if (penyewaan != null) {
                                        // Load the related data

                                        // Load mobil data
                                        int idMobil = penyewaan.getIdMobil();
                                        controller.MobilController mobilController = new controller.MobilController();
                                        model.Mobil mobil = mobilController.getMobilById(idMobil);

                                        if (mobil != null) {
                                                txtidmobil.setText(String.valueOf(mobil.getIdMobil()));
                                                txtnopolisi.setText(mobil.getNoPolisi());
                                                txtmerk.setText(mobil.getMerk());
                                                if (txttahun != null) {
                                                        txttahun.setYear(mobil.getTahun());
                                                }
                                                txthargamobil.setText(String.valueOf(mobil.getHargaSewa()));
                                        }

                                        // Load pelanggan data
                                        int idPelanggan = penyewaan.getIdPelanggan();
                                        controller.PelangganController pelangganController = new controller.PelangganController();
                                        model.Pelanggan pelanggan = pelangganController.getPelangganById(idPelanggan);

                                        if (pelanggan != null) {
                                                txtidpelanggan.setText(String.valueOf(pelanggan.getIdPelanggan()));
                                                txtnamapelanggan.setText(pelanggan.getNama());
                                                txtnohp.setText(pelanggan.getNoTelepon());
                                                txtalamat.setText(pelanggan.getAlamat());
                                        }

                                        // Load sopir data if exists
                                        if (penyewaan.getIdSopir() != null) {
                                                int idSopir = penyewaan.getIdSopir();
                                                controller.SopirController sopirController = new controller.SopirController();
                                                model.Sopir sopir = sopirController.getSopirById(idSopir);

                                                if (sopir != null) {
                                                        txtidsopir.setText(String.valueOf(sopir.getIdSopir()));
                                                        txtnamasopir.setText(sopir.getNama());
                                                        txtnosim.setText(sopir.getNoSim());
                                                        txttarifsopir.setText(String.valueOf(sopir.getTarifPerHari()));
                                                }
                                        } else {
                                                // Clear sopir fields if no sopir
                                                clearSopirFields();
                                        }

                                        // Load dates
                                        txttanggalsewa.setDate(penyewaan.getTglSewa());
                                        txttanggalpengembalian.setDate(penyewaan.getTglKembaliRencana());

                                        // Load pricing
                                        labeltotalhari.setText(String.valueOf(DateUtil.hitungSelisihHari(
                                                        penyewaan.getTglSewa(), penyewaan.getTglKembaliRencana())));

                                        NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(
                                                        new Locale.Builder().setLanguage("id").setRegion("ID").build());
                                        currencyFormat.setMaximumFractionDigits(0);
                                        labeltotalharga.setText(currencyFormat.format(penyewaan.getTotalHarga()));
                                }
                        } catch (Exception e) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "Error saat memuat data: " + e.getMessage(),
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                e.printStackTrace();
                        }
                }
        }// GEN-LAST:event_tpenyewaanMouseClicked

        private void btnsewaActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnsewaActionPerformed
                // Validate all required fields first
                if (txtidmobil.getText().isEmpty()) {
                        javax.swing.JOptionPane.showMessageDialog(this, "Harap pilih mobil terlebih dahulu!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                if (txtidpelanggan.getText().isEmpty()) {
                        javax.swing.JOptionPane.showMessageDialog(this, "Harap pilih pelanggan terlebih dahulu!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                if (txttanggalsewa.getDate() == null || txttanggalpengembalian.getDate() == null) {
                        javax.swing.JOptionPane.showMessageDialog(this,
                                        "Harap pilih tanggal sewa dan tanggal pengembalian!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                if (labeltotalhari.getText().equals("-") || labeltotalharga.getText().equals("-")) {
                        javax.swing.JOptionPane.showMessageDialog(this, "Harap hitung total biaya terlebih dahulu!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                try {
                        // Get the IDs
                        int idMobil = Integer.parseInt(txtidmobil.getText());
                        int idPelanggan = Integer.parseInt(txtidpelanggan.getText());

                        // Sopir is optional
                        Integer idSopir = null;
                        if (!txtidsopir.getText().isEmpty()) {
                                idSopir = Integer.parseInt(txtidsopir.getText());
                        }

                        // Get current user ID (karyawan)
                        int idKaryawan = utils.UserSession.getInstance().getIdKaryawan();

                        // Convert GUI dates to SQL dates - using direct conversion
                        // We don't need DateUtil here since we're just converting java.util.Date to
                        // java.sql.Date
                        java.sql.Date tglSewa = new java.sql.Date(txttanggalsewa.getDate().getTime());
                        java.sql.Date tglKembaliRencana = new java.sql.Date(txttanggalpengembalian.getDate().getTime());

                        // Parse total harga (remove currency formatting)
                        String hargaText = labeltotalharga.getText().replaceAll("[^0-9]", "");
                        int totalHarga = Integer.parseInt(hargaText);

                        // Create new penyewaan
                        controller.PenyewaanController penyewaanController = new controller.PenyewaanController();
                        boolean success = penyewaanController.addPenyewaan(
                                        idPelanggan, idMobil, idSopir, 2, tglSewa, tglKembaliRencana,
                                        totalHarga);

                        if (success) {
                                javax.swing.JOptionPane.showMessageDialog(this, "Penyewaan berhasil ditambahkan!",
                                                "Sukses", javax.swing.JOptionPane.INFORMATION_MESSAGE);
                                // Clear form and reload table
                                clearForm();
                                refreshPenyewaanTable();
                        } else {
                                javax.swing.JOptionPane.showMessageDialog(this, "Gagal menambahkan penyewaan!",
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                        }

                } catch (Exception e) {
                        javax.swing.JOptionPane.showMessageDialog(this, "Error: " + e.getMessage(),
                                        "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                        e.printStackTrace();
                }
        }// GEN-LAST:event_btnsewaActionPerformed

        private void btnclearActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnclearActionPerformed
                // Clear all fields in the form
                clearForm();
        }// GEN-LAST:event_btnclearActionPerformed

        /**
         * Initialize the panel data
         */
        private void init() {
                // Set today's date as default for tanggal sewa
                txttanggalsewa.setDate(new java.util.Date());

                // Refresh the penyewaan table
                refreshPenyewaanTable();
        }

        /**
         * Refresh the penyewaan table with updated data
         */
        private void refreshPenyewaanTable() {
                // Create table model
                String[] columns = { "ID Sewa", "Pelanggan", "Mobil", "Sopir", "Tgl Sewa", "Tgl Kembali", "Total Harga",
                                "Status" };
                DefaultTableModel model = new DefaultTableModel(columns, 0) {
                        @Override
                        public boolean isCellEditable(int row, int column) {
                                return false;
                        }
                };

                // Get data from controller
                List<Penyewaan> penyewaanList = penyewaanController.getAllPenyewaan();

                // Use DateUtil for formatting dates
                // No need to create a SimpleDateFormat instance
                // Format for currency
                NumberFormat currencyFormat = NumberFormat
                                .getCurrencyInstance(new Locale.Builder().setLanguage("id").setRegion("ID").build());
                currencyFormat.setMaximumFractionDigits(0);

                // Add data to model
                for (Penyewaan penyewaan : penyewaanList) {
                        // Get pelanggan name
                        Pelanggan pelanggan = pelangganController.getPelangganById(penyewaan.getIdPelanggan());
                        String pelangganName = (pelanggan != null) ? pelanggan.getNama() : "-";

                        // Get mobil info
                        Mobil mobil = mobilController.getMobilById(penyewaan.getIdMobil());
                        String mobilInfo = (mobil != null) ? mobil.getMerk() + " (" + mobil.getNoPolisi() + ")" : "-";

                        // Get sopir name
                        String sopirName = "-";
                        if (penyewaan.getIdSopir() != null) {
                                Sopir sopir = sopirController.getSopirById(penyewaan.getIdSopir());
                                if (sopir != null) {
                                        sopirName = sopir.getNama();
                                }
                        }

                        Object[] row = {
                                        penyewaan.getIdSewa(),
                                        pelangganName,
                                        mobilInfo,
                                        sopirName,
                                        DateUtil.formatTanggal(penyewaan.getTglSewa()),
                                        DateUtil.formatTanggal(penyewaan.getTglKembaliRencana()),
                                        currencyFormat.format(penyewaan.getTotalHarga()),
                                        penyewaan.getStatus()
                        };
                        model.addRow(row);
                }

                // Set model to table
                tpenyewaan.setModel(model);
        }

        /**
         * Clear all form fields
         */
        private void clearForm() {
                // Clear mobil fields
                txtidmobil.setText("");
                txtnopolisi.setText("");
                txtmerk.setText("");
                if (txttahun != null) {
                        txttahun.setValue(java.util.Calendar.getInstance().get(java.util.Calendar.YEAR));
                }
                txthargamobil.setText("");

                // Clear pelanggan fields
                txtidpelanggan.setText("");
                txtnamapelanggan.setText("");
                txtnohp.setText("");
                txtalamat.setText("");

                // Clear sopir fields
                txtidsopir.setText("");
                txtnamasopir.setText("");
                txtnosim.setText("");
                txttarifsopir.setText("");

                // Reset date fields
                txttanggalsewa.setDate(new java.util.Date()); // Set to current date
                txttanggalpengembalian.setDate(null);

                labelidpenyewaan.setText("-");

                // Reset calculation labels
                labeltotalhari.setText("-");
                labeltotalharga.setText("-");
        }

        /**
         * Clear all mobil-related fields
         */
        private void clearMobilFields() {
                txtidmobil.setText("");
                txtnopolisi.setText("");
                txtmerk.setText("");
                if (txttahun != null) {
                        txttahun.setYear(java.util.Calendar.getInstance().get(java.util.Calendar.YEAR));
                }
                txthargamobil.setText("");
        }

        /**
         * Clear all pelanggan-related fields
         */
        private void clearPelangganFields() {
                txtidpelanggan.setText("");
                txtnamapelanggan.setText("");
                txtnohp.setText("");
                txtalamat.setText("");
        }

        /**
         * Clear all sopir-related fields
         */
        private void clearSopirFields() {
                txtidsopir.setText("");
                txtnamasopir.setText("");
                txtnosim.setText("");
                txttarifsopir.setText("");
        }

        private void btnlistmobilActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnlistmobilActionPerformed
                // Create dialog
                DialogMobil dialog = new DialogMobil(javax.swing.JFrame.getFrames()[0], true);

                // Get mobil data
                controller.MobilController mobilController = new controller.MobilController();
                java.util.List<model.Mobil> mobilList = mobilController.getAvailableMobil();

                // Create table model
                String[] columns = { "ID", "Merk", "No. Polisi", "Tahun", "Status", "Harga Sewa" };
                javax.swing.table.DefaultTableModel model = new javax.swing.table.DefaultTableModel(columns, 0) {
                        @Override
                        public boolean isCellEditable(int row, int column) {
                                return false;
                        }
                };

                // Fill table with data
                for (model.Mobil mobil : mobilList) {
                        model.addRow(new Object[] {
                                        mobil.getIdMobil(),
                                        mobil.getMerk(),
                                        mobil.getNoPolisi(),
                                        mobil.getTahun(),
                                        mobil.getStatus(),
                                        mobil.getHargaSewa()
                        });
                }

                // Set model to table and configure dialog
                dialog.getTable().setModel(model);

                // Handle search functionality
                dialog.getBtnCari().addActionListener(e -> {
                        String keyword = dialog.getTextCari().getText().toLowerCase();
                        javax.swing.table.DefaultTableModel searchModel = new javax.swing.table.DefaultTableModel(
                                        columns, 0) {
                                @Override
                                public boolean isCellEditable(int row, int column) {
                                        return false;
                                }
                        };

                        for (model.Mobil mobil : mobilList) {
                                if (mobil.getMerk().toLowerCase().contains(keyword)
                                                || mobil.getNoPolisi().toLowerCase().contains(keyword)) {
                                        searchModel.addRow(new Object[] {
                                                        mobil.getIdMobil(),
                                                        mobil.getMerk(),
                                                        mobil.getNoPolisi(),
                                                        mobil.getTahun(),
                                                        mobil.getStatus(),
                                                        mobil.getHargaSewa()
                                        });
                                }
                        }
                        dialog.getTable().setModel(searchModel);
                });

                // Handle double-click selection
                dialog.getTable().addMouseListener(new java.awt.event.MouseAdapter() {
                        @Override
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                                if (evt.getClickCount() == 2) {
                                        int row = dialog.getTable().getSelectedRow();
                                        if (row >= 0) {
                                                int idMobil = (int) dialog.getTable().getValueAt(row, 0);
                                                model.Mobil selectedMobil = mobilController.getMobilById(idMobil);

                                                // Fill the form fields with selected data
                                                txtidmobil.setText(String.valueOf(selectedMobil.getIdMobil()));
                                                txtnopolisi.setText(selectedMobil.getNoPolisi());
                                                txtmerk.setText(selectedMobil.getMerk());
                                                txttahun.setYear(selectedMobil.getTahun());
                                                txthargamobil.setText(String.valueOf(selectedMobil.getHargaSewa()));

                                                // Close the dialog
                                                dialog.dispose();
                                        }
                                }
                        }
                });

                // Show dialog
                dialog.setTitle("Pilih Mobil");
                dialog.setLocationRelativeTo(null);
                dialog.setVisible(true);
        }// GEN-LAST:event_btnlistmobilActionPerformed

        private void setupMobilTable(DialogMobil dialog) {
                // Initialize controller
                controller.MobilController mobilController = new controller.MobilController();

                // Get list of available mobil
                java.util.List<model.Mobil> mobilList = mobilController.getAvailableMobil();

                // Set up table model
                javax.swing.table.DefaultTableModel tableModel = new javax.swing.table.DefaultTableModel(
                                new Object[][] {},
                                new String[] { "ID", "Merk", "No. Polisi", "Tahun", "Status", "Harga Sewa" }) {
                        @Override
                        public boolean isCellEditable(int row, int column) {
                                return false; // Make all cells non-editable
                        }
                };

                // Add data to the model
                for (model.Mobil mobil : mobilList) {
                        tableModel.addRow(new Object[] {
                                        mobil.getIdMobil(),
                                        mobil.getMerk(),
                                        mobil.getNoPolisi(),
                                        mobil.getTahun(),
                                        mobil.getStatus(),
                                        mobil.getHargaSewa()
                        });
                }

                // Set the model to the table
                dialog.getTable().setModel(tableModel);

                // Set up the double-click event to select a mobil
                dialog.getTable().addMouseListener(new java.awt.event.MouseAdapter() {
                        @Override
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                                if (evt.getClickCount() == 2) { // Double click
                                        int selectedRow = dialog.getTable().getSelectedRow();
                                        if (selectedRow >= 0) {
                                                // Get the selected mobil ID
                                                int idMobil = (int) dialog.getTable().getValueAt(selectedRow, 0);

                                                // Find the selected mobil
                                                model.Mobil selectedMobil = mobilController.getMobilById(idMobil);

                                                // Set the values to the form
                                                txtidmobil.setText(String.valueOf(selectedMobil.getIdMobil()));
                                                txtnopolisi.setText(selectedMobil.getNoPolisi());
                                                txtmerk.setText(selectedMobil.getMerk());
                                                txttahun.setYear(selectedMobil.getTahun());
                                                txthargamobil.setText(String.valueOf(selectedMobil.getHargaSewa()));

                                                // Close the dialog
                                                dialog.dispose();
                                        }
                                }
                        }
                });

                // Set up the search functionality
                dialog.getBtnCari().addActionListener(new java.awt.event.ActionListener() {
                        @Override
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                String keyword = dialog.getTextCari().getText().toLowerCase();

                                javax.swing.table.DefaultTableModel filteredModel = new javax.swing.table.DefaultTableModel(
                                                new Object[][] {},
                                                new String[] { "ID", "Merk", "No. Polisi", "Tahun", "Status",
                                                                "Harga Sewa" }) {
                                        @Override
                                        public boolean isCellEditable(int row, int column) {
                                                return false;
                                        }
                                };

                                for (model.Mobil mobil : mobilList) {
                                        if (mobil.getMerk().toLowerCase().contains(keyword)
                                                        || mobil.getNoPolisi().toLowerCase().contains(keyword)) {
                                                filteredModel.addRow(new Object[] {
                                                                mobil.getIdMobil(),
                                                                mobil.getMerk(),
                                                                mobil.getNoPolisi(),
                                                                mobil.getTahun(),
                                                                mobil.getStatus(),
                                                                mobil.getHargaSewa()
                                                });
                                        }
                                }

                                dialog.getTable().setModel(filteredModel);
                        }
                });

                dialog.getBtnRefresh().addActionListener(new java.awt.event.ActionListener() {
                        @Override
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                // Refresh the table with updated mobil data
                                setupMobilTable(dialog);
                        }
                });
        }

        private void btnlistpelangganActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnlistpelangganActionPerformed
                // Create and display the dialog
                DialogPelanggan dialog = new DialogPelanggan(javax.swing.JFrame.getFrames()[0], true);

                // Set up the dialog table with pelanggan data
                setupPelangganTable(dialog);

                dialog.setTitle("Pilih Pelanggan");
                dialog.setLocationRelativeTo(null);
                dialog.setVisible(true);
        }// GEN-LAST:event_btnlistpelangganActionPerformed

        private void setupPelangganTable(DialogPelanggan dialog) {
                // Initialize controller
                controller.PelangganController pelangganController = new controller.PelangganController();

                // Get list of all pelanggan
                java.util.List<model.Pelanggan> pelangganList = pelangganController.getAllPelanggan();

                // Set up table model
                javax.swing.table.DefaultTableModel tableModel = new javax.swing.table.DefaultTableModel(
                                new Object[][] {},
                                new String[] { "ID", "Nama", "No. Telepon", "Alamat" }) {
                        @Override
                        public boolean isCellEditable(int row, int column) {
                                return false; // Make all cells non-editable
                        }
                };

                // Add data to the model
                for (model.Pelanggan pelanggan : pelangganList) {
                        tableModel.addRow(new Object[] {
                                        pelanggan.getIdPelanggan(),
                                        pelanggan.getNama(),
                                        pelanggan.getNoTelepon(),
                                        pelanggan.getAlamat()
                        });
                }

                // Set the model to the table
                dialog.getTable().setModel(tableModel);

                // Set up the double-click event to select a pelanggan
                dialog.getTable().addMouseListener(new java.awt.event.MouseAdapter() {
                        @Override
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                                if (evt.getClickCount() == 2) { // Double click
                                        int selectedRow = dialog.getTable().getSelectedRow();
                                        if (selectedRow >= 0) {
                                                // Get the selected pelanggan ID
                                                int idPelanggan = (int) dialog.getTable().getValueAt(selectedRow, 0);

                                                // Find the selected pelanggan
                                                model.Pelanggan selectedPelanggan = pelangganController
                                                                .getPelangganById(idPelanggan);

                                                // Set the values to the form
                                                txtidpelanggan.setText(
                                                                String.valueOf(selectedPelanggan.getIdPelanggan()));
                                                txtnamapelanggan.setText(selectedPelanggan.getNama());
                                                txtnohp.setText(selectedPelanggan.getNoTelepon());
                                                txtalamat.setText(selectedPelanggan.getAlamat());

                                                // Close the dialog
                                                dialog.dispose();
                                        }
                                }
                        }
                });

                // Set up the search functionality
                dialog.getBtnCari().addActionListener(new java.awt.event.ActionListener() {
                        @Override
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                String keyword = dialog.getTextCari().getText().toLowerCase();

                                javax.swing.table.DefaultTableModel filteredModel = new javax.swing.table.DefaultTableModel(
                                                new Object[][] {},
                                                new String[] { "ID", "Nama", "No. Telepon", "Alamat" }) {
                                        @Override
                                        public boolean isCellEditable(int row, int column) {
                                                return false;
                                        }
                                };

                                for (model.Pelanggan pelanggan : pelangganList) {
                                        if (pelanggan.getNama().toLowerCase().contains(keyword)
                                                        || pelanggan.getNoTelepon().toLowerCase().contains(keyword)
                                                        || pelanggan.getAlamat().toLowerCase().contains(keyword)) {
                                                filteredModel.addRow(new Object[] {
                                                                pelanggan.getIdPelanggan(),
                                                                pelanggan.getNama(),
                                                                pelanggan.getNoTelepon(),
                                                                pelanggan.getAlamat()
                                                });
                                        }
                                }

                                dialog.getTable().setModel(filteredModel);
                        }
                });
                dialog.getBtnRefresh().addActionListener(new java.awt.event.ActionListener() {
                        @Override
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                // Refresh the table with updated pelanggan data
                                setupPelangganTable(dialog);
                        }
                });
        }

        private void btnlistsopirActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnlistsopirActionPerformed
                // Create and display the dialog
                DialogSopir dialog = new DialogSopir(javax.swing.JFrame.getFrames()[0], true);

                // Set up the dialog table with available sopir
                setupSopirTable(dialog);

                dialog.setTitle("Pilih Sopir");
                dialog.setLocationRelativeTo(null);
                dialog.setVisible(true);
        }// GEN-LAST:event_btnlistsopirActionPerformed

        private void setupSopirTable(DialogSopir dialog) {
                // Initialize controller
                controller.SopirController sopirController = new controller.SopirController();

                // Get list of available sopir
                java.util.List<model.Sopir> sopirList = sopirController.getAvailableSopir();

                // Set up table model
                javax.swing.table.DefaultTableModel tableModel = new javax.swing.table.DefaultTableModel(
                                new Object[][] {},
                                new String[] { "ID", "Nama", "No. SIM", "Status", "Tarif/Hari" }) {
                        @Override
                        public boolean isCellEditable(int row, int column) {
                                return false; // Make all cells non-editable
                        }
                };

                // Add data to the model
                for (model.Sopir sopir : sopirList) {
                        tableModel.addRow(new Object[] {
                                        sopir.getIdSopir(),
                                        sopir.getNama(),
                                        sopir.getNoSim(),
                                        sopir.getStatus(),
                                        sopir.getTarifPerHari()
                        });
                }

                // Set the model to the table
                dialog.getTable().setModel(tableModel);

                // Set up the double-click event to select a sopir
                dialog.getTable().addMouseListener(new java.awt.event.MouseAdapter() {
                        @Override
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
                                if (evt.getClickCount() == 2) { // Double click
                                        int selectedRow = dialog.getTable().getSelectedRow();
                                        if (selectedRow >= 0) {
                                                // Get the selected sopir ID
                                                int idSopir = (int) dialog.getTable().getValueAt(selectedRow, 0);

                                                // Find the selected sopir
                                                model.Sopir selectedSopir = sopirController.getSopirById(idSopir);

                                                // Set the values to the form
                                                txtidsopir.setText(String.valueOf(selectedSopir.getIdSopir()));
                                                txtnamasopir.setText(selectedSopir.getNama());
                                                txtnosim.setText(selectedSopir.getNoSim());
                                                txttarifsopir.setText(String.valueOf(selectedSopir.getTarifPerHari()));

                                                // Close the dialog
                                                dialog.dispose();
                                        }
                                }
                        }
                });

                // Set up the search functionality
                dialog.getBtnCari().addActionListener(new java.awt.event.ActionListener() {
                        @Override
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                String keyword = dialog.getTextCari().getText().toLowerCase();

                                javax.swing.table.DefaultTableModel filteredModel = new javax.swing.table.DefaultTableModel(
                                                new Object[][] {},
                                                new String[] { "ID", "Nama", "No. SIM", "Status", "Tarif/Hari" }) {
                                        @Override
                                        public boolean isCellEditable(int row, int column) {
                                                return false;
                                        }
                                };

                                for (model.Sopir sopir : sopirList) {
                                        if (sopir.getNama().toLowerCase().contains(keyword)
                                                        || sopir.getNoSim().toLowerCase().contains(keyword)) {
                                                filteredModel.addRow(new Object[] {
                                                                sopir.getIdSopir(),
                                                                sopir.getNama(),
                                                                sopir.getNoSim(),
                                                                sopir.getStatus(),
                                                                sopir.getTarifPerHari()
                                                });
                                        }
                                }

                                dialog.getTable().setModel(filteredModel);
                        }
                });

                dialog.getBtnRefresh1().addActionListener(new java.awt.event.ActionListener() {
                        @Override
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                // Refresh the table with updated sopir data
                                setupSopirTable(dialog);
                        }
                });
        }

        private void btntanpasopirActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btntanpasopirActionPerformed
                // Clear the sopir related fields
                txtidsopir.setText("");
                txtnamasopir.setText("");
                txtnosim.setText("");
                txttarifsopir.setText("");

                // Recalculate total if dates and mobil are selected
                if (txttanggalsewa.getDate() != null && txttanggalpengembalian.getDate() != null
                                && !txtidmobil.getText().isEmpty()) {
                        hitungTotalHargaSewa();
                }
        }// GEN-LAST:event_btntanpasopirActionPerformed

        private void btnhitungActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnhitungActionPerformed
                // Validate required fields for calculation
                if (txttanggalsewa.getDate() == null || txttanggalpengembalian.getDate() == null) {
                        javax.swing.JOptionPane.showMessageDialog(this,
                                        "Harap pilih tanggal sewa dan tanggal pengembalian terlebih dahulu!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                if (txtidmobil.getText().isEmpty()) {
                        javax.swing.JOptionPane.showMessageDialog(this,
                                        "Harap pilih mobil terlebih dahulu!",
                                        "Validasi", javax.swing.JOptionPane.WARNING_MESSAGE);
                        return;
                }

                hitungTotalHargaSewa();
        }// GEN-LAST:event_btnhitungActionPerformed

        private void txtidmobilActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_txtidmobilActionPerformed
                // If there's an ID, try to load the mobil data
                if (!txtidmobil.getText().isEmpty()) {
                        try {
                                int idMobil = Integer.parseInt(txtidmobil.getText());
                                controller.MobilController mobilController = new controller.MobilController();
                                model.Mobil mobil = mobilController.getMobilById(idMobil);

                                if (mobil != null) {
                                        txtnopolisi.setText(mobil.getNoPolisi());
                                        txtmerk.setText(mobil.getMerk());
                                        if (txttahun != null) {
                                                txttahun.setYear(mobil.getTahun());
                                        }
                                        txthargamobil.setText(String.valueOf(mobil.getHargaSewa()));

                                        // If dates are selected, calculate total
                                        if (txttanggalsewa.getDate() != null
                                                        && txttanggalpengembalian.getDate() != null) {
                                                hitungTotalHargaSewa();
                                        }
                                } else {
                                        javax.swing.JOptionPane.showMessageDialog(this,
                                                        "Mobil dengan ID tersebut tidak ditemukan",
                                                        "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                        clearMobilFields();
                                }
                        } catch (NumberFormatException e) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "ID Mobil harus berupa angka",
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                clearMobilFields();
                        }
                }
        }// GEN-LAST:event_txtidmobilActionPerformed

        private void txtnopolisiActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_txtnopolisiActionPerformed
                // If there's a no polisi, try to find the mobil by no polisi
                if (!txtnopolisi.getText().isEmpty()) {
                        controller.MobilController mobilController = new controller.MobilController();
                        List<model.Mobil> mobilList = mobilController.getAvailableMobil();

                        boolean found = false;
                        for (model.Mobil mobil : mobilList) {
                                if (mobil.getNoPolisi().equalsIgnoreCase(txtnopolisi.getText())) {
                                        txtidmobil.setText(String.valueOf(mobil.getIdMobil()));
                                        txtmerk.setText(mobil.getMerk());
                                        if (txttahun != null) {
                                                txttahun.setYear(mobil.getTahun());
                                        }
                                        txthargamobil.setText(String.valueOf(mobil.getHargaSewa()));

                                        // If dates are selected, calculate total
                                        if (txttanggalsewa.getDate() != null
                                                        && txttanggalpengembalian.getDate() != null) {
                                                hitungTotalHargaSewa();
                                        }

                                        found = true;
                                        break;
                                }
                        }

                        if (!found) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "Mobil dengan No. Polisi tersebut tidak ditemukan atau tidak tersedia",
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                clearMobilFields();
                        }
                }
        }// GEN-LAST:event_txtnopolisiActionPerformed

        private void txtidpelangganActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_txtidpelangganActionPerformed
                // If there's an ID, try to load the pelanggan data
                if (!txtidpelanggan.getText().isEmpty()) {
                        try {
                                int idPelanggan = Integer.parseInt(txtidpelanggan.getText());
                                controller.PelangganController pelangganController = new controller.PelangganController();
                                model.Pelanggan pelanggan = pelangganController.getPelangganById(idPelanggan);

                                if (pelanggan != null) {
                                        txtnamapelanggan.setText(pelanggan.getNama());
                                        txtnohp.setText(pelanggan.getNoTelepon());
                                        txtalamat.setText(pelanggan.getAlamat());
                                } else {
                                        javax.swing.JOptionPane.showMessageDialog(this,
                                                        "Pelanggan dengan ID tersebut tidak ditemukan",
                                                        "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                        clearPelangganFields();
                                }
                        } catch (NumberFormatException e) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "ID Pelanggan harus berupa angka",
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                clearPelangganFields();
                        }
                }
        }// GEN-LAST:event_txtidpelangganActionPerformed

        private void txtidsopirActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_txtidsopirActionPerformed
                // If there's an ID, try to load the sopir data
                if (!txtidsopir.getText().isEmpty()) {
                        try {
                                int idSopir = Integer.parseInt(txtidsopir.getText());
                                controller.SopirController sopirController = new controller.SopirController();
                                model.Sopir sopir = sopirController.getSopirById(idSopir);

                                if (sopir != null && "tersedia".equalsIgnoreCase(sopir.getStatus())) {
                                        txtnamasopir.setText(sopir.getNama());
                                        txtnosim.setText(sopir.getNoSim());
                                        txttarifsopir.setText(String.valueOf(sopir.getTarifPerHari()));

                                        // If dates and mobil are selected, calculate total
                                        if (txttanggalsewa.getDate() != null && txttanggalpengembalian.getDate() != null
                                                        && !txtidmobil.getText().isEmpty()) {
                                                hitungTotalHargaSewa();
                                        }
                                } else {
                                        String message = (sopir == null) ? "Sopir dengan ID tersebut tidak ditemukan"
                                                        : "Sopir dengan ID tersebut tidak tersedia (status: "
                                                                        + sopir.getStatus() + ")";

                                        javax.swing.JOptionPane.showMessageDialog(this,
                                                        message, "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                        clearSopirFields();
                                }
                        } catch (NumberFormatException e) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "ID Sopir harus berupa angka",
                                                "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                clearSopirFields();
                        }
                }
        }// GEN-LAST:event_txtidsopirActionPerformed

        /**
         * Calculate the total rental price based on selected dates and rates
         */
        private void hitungTotalHargaSewa() {
                try {
                        // Calculate days difference
                        java.util.Date tglSewa = txttanggalsewa.getDate();
                        java.util.Date tglKembali = txttanggalpengembalian.getDate();

                        if (tglSewa == null || tglKembali == null) {
                                return;
                        }

                        // Use DateUtil to calculate the days difference
                        // The improved DateUtil.hitungSelisihHari already handles:
                        // 1. Same day rentals (returns 1)
                        // 2. Negative day differences (returns positive value with minimum 1)
                        int diffInDays = DateUtil.hitungSelisihHari(tglSewa, tglKembali);

                        // Display the number of days
                        labeltotalhari.setText(String.valueOf(diffInDays));

                        // Get mobil price
                        int hargaMobil = 0;
                        if (!txthargamobil.getText().isEmpty()) {
                                hargaMobil = Integer.parseInt(txthargamobil.getText());
                        }

                        // Get sopir price if applicable
                        int hargaSopir = 0;
                        if (!txttarifsopir.getText().isEmpty()) {
                                hargaSopir = Integer.parseInt(txttarifsopir.getText());
                        }

                        // Calculate total price
                        int totalHarga = (int) ((hargaMobil + hargaSopir) * diffInDays);

                        // Format as currency
                        NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(
                                        new Locale.Builder().setLanguage("id").setRegion("ID").build());
                        currencyFormat.setMaximumFractionDigits(0); // Set to show 0 decimal places
                        labeltotalharga.setText(currencyFormat.format(totalHarga));

                } catch (Exception e) {
                        javax.swing.JOptionPane.showMessageDialog(this,
                                        "Error saat menghitung harga: " + e.getMessage(),
                                        "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                        e.printStackTrace();
                }
        }

        // Variables declaration - do not modify//GEN-BEGIN:variables
        private javax.swing.JButton btnclear;
        private javax.swing.JButton btnhapus;
        private javax.swing.JButton btnhitung;
        private javax.swing.JButton btnlistmobil;
        private javax.swing.JButton btnlistpelanggan;
        private javax.swing.JButton btnlistsopir;
        private javax.swing.JButton btnrefresh;
        private javax.swing.JButton btnsewa;
        private javax.swing.JButton btntanpasopir;
        private javax.swing.JLabel jLabel1;
        private javax.swing.JLabel jLabel10;
        private javax.swing.JLabel jLabel11;
        private javax.swing.JLabel jLabel12;
        private javax.swing.JLabel jLabel13;
        private javax.swing.JLabel jLabel14;
        private javax.swing.JLabel jLabel15;
        private javax.swing.JLabel jLabel16;
        private javax.swing.JLabel jLabel17;
        private javax.swing.JLabel jLabel18;
        private javax.swing.JLabel jLabel19;
        private javax.swing.JLabel jLabel2;
        private javax.swing.JLabel jLabel3;
        private javax.swing.JLabel jLabel4;
        private javax.swing.JLabel jLabel5;
        private javax.swing.JLabel jLabel6;
        private javax.swing.JLabel jLabel7;
        private javax.swing.JLabel jLabel8;
        private javax.swing.JLabel jLabel9;
        private javax.swing.JPanel jPanel1;
        private javax.swing.JPanel jPanel2;
        private javax.swing.JPanel jPanel3;
        private javax.swing.JPanel jPanel4;
        private javax.swing.JPanel jPanel5;
        private javax.swing.JPanel jPanel6;
        private javax.swing.JScrollPane jScrollPane1;
        private javax.swing.JScrollPane jScrollPane2;
        private javax.swing.JSeparator jSeparator1;
        private javax.swing.JSeparator jSeparator2;
        private javax.swing.JSeparator jSeparator3;
        private javax.swing.JSeparator jSeparator4;
        private javax.swing.JLabel labelidpenyewaan;
        private javax.swing.JLabel labeltotalharga;
        private javax.swing.JLabel labeltotalhari;
        private javax.swing.JTable tpenyewaan;
        private javax.swing.JTextArea txtalamat;
        private javax.swing.JTextField txthargamobil;
        private javax.swing.JTextField txtidmobil;
        private javax.swing.JTextField txtidpelanggan;
        private javax.swing.JTextField txtidsopir;
        private javax.swing.JTextField txtmerk;
        private javax.swing.JTextField txtnamapelanggan;
        private javax.swing.JTextField txtnamasopir;
        private javax.swing.JTextField txtnohp;
        private javax.swing.JTextField txtnopolisi;
        private javax.swing.JTextField txtnosim;
        private com.toedter.calendar.JYearChooser txttahun;
        private com.toedter.calendar.JDateChooser txttanggalpengembalian;
        private com.toedter.calendar.JDateChooser txttanggalsewa;
        private javax.swing.JTextField txttarifsopir;
        // End of variables declaration//GEN-END:variables
}
